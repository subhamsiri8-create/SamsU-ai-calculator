<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Care n Cure Bill Generator</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #0891b2; /* Medical Cyan */
            --text: #1f2937;
            --border: #e5e7eb;
            --bg: #f3f4f6;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
        }

        /* --- THE INVOICE SHEET (A4 Size) --- */
        .invoice-sheet {
            background: white;
            width: 210mm; /* A4 Width */
            min-height: 297mm; /* A4 Height */
            padding: 20mm;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            position: relative;
            box-sizing: border-box;
        }

        /* --- EDITABLE FIELDS STYLING --- */
        input, textarea, select {
            border: 1px dashed #ccc;
            padding: 5px;
            font-family: inherit;
            color: inherit;
            background: transparent;
            width: 100%;
            box-sizing: border-box;
            border-radius: 4px;
        }
        input:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            background: rgba(8, 145, 178, 0.05);
        }
        
        /* HEADER */
        .header { display: flex; justify-content: space-between; align-items: flex-start; border-bottom: 2px solid var(--primary); padding-bottom: 20px; margin-bottom: 20px; }
        .hospital-info { width: 65%; }
        .hospital-input { font-size: 2rem; font-weight: 800; color: var(--primary); margin-bottom: 5px; border: none; text-transform: uppercase; }
        .sub-input { font-size: 0.95rem; color: #444; margin-bottom: 2px; font-weight: 500;}
        
        .invoice-meta { text-align: right; width: 30%; }
        .meta-group { display: flex; gap: 10px; margin-bottom: 5px; align-items: center; justify-content: flex-end; }
        .meta-label { font-weight: bold; font-size: 0.9rem; }

        /* PATIENT INFO */
        .patient-section { background: #ecfeff; padding: 15px; border-radius: 8px; margin-bottom: 25px; border: 1px solid #cffafe; }
        .row { display: flex; gap: 20px; margin-bottom: 10px; }
        .col { flex: 1; }
        .label { font-size: 0.8rem; color: #555; display: block; margin-bottom: 3px; font-weight: 600; }

        /* BILLING TABLE */
        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        th { text-align: left; background: var(--primary); color: white; padding: 10px; font-size: 0.9rem; }
        td { border-bottom: 1px solid var(--border); padding: 10px; vertical-align: top; }
        
        .qty-col { width: 60px; }
        .price-col { width: 100px; text-align: right; }
        .total-col { width: 120px; text-align: right; font-weight: bold; background: #f9fafb; }
        .action-col { width: 40px; text-align: center; }

        .btn-remove { color: red; cursor: pointer; border: none; background: none; font-size: 1.2rem; }
        .btn-add {
            display: block; width: 100%; padding: 10px; background: #ecfdf5; 
            color: #059669; border: 1px dashed #059669; text-align: center; 
            cursor: pointer; margin-top: 10px; border-radius: 5px; font-weight: bold;
        }
        .btn-add:hover { background: #d1fae5; }

        /* TOTALS SECTION */
        .totals-section { display: flex; justify-content: flex-end; margin-top: 20px; }
        .totals-box { width: 300px; }
        .total-row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #eee; }
        .grand-total { font-size: 1.4rem; font-weight: bold; color: var(--primary); border-top: 2px solid var(--primary); border-bottom: none; margin-top: 5px; padding-top: 10px;}

        /* FOOTER / CONTROLS */
        .controls {
            position: fixed; top: 20px; right: 20px; display: flex; flex-direction: column; gap: 10px;
        }
        .float-btn {
            background: var(--primary); color: white; border: none; padding: 15px 20px;
            border-radius: 50px; cursor: pointer; box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            font-weight: bold; display: flex; align-items: center; gap: 10px; transition: transform 0.2s;
        }
        .float-btn:hover { transform: translateY(-2px); background: #0e7490; }
        .float-btn.secondary { background: white; color: var(--text); }

        .footer-note { margin-top: 40px; text-align: center; font-size: 0.8rem; color: #999; border-top: 1px solid #eee; padding-top: 10px; }

        /* --- PRINT MODE --- */
        @media print {
            body { background: white; padding: 0; }
            .invoice-sheet { box-shadow: none; width: 100%; padding: 0; margin: 0; }
            .controls, .btn-add, .action-col, .btn-remove { display: none !important; }
            input, textarea, select { border: none !important; resize: none; padding: 0; }
            input::placeholder { color: transparent; }
            @page { margin: 15mm; }
        }
    </style>
</head>
<body>

<div class="controls">
    <button class="float-btn" onclick="window.print()"><i class="fa fa-print"></i> Print / PDF</button>
    <button class="float-btn secondary" onclick="resetBill()"><i class="fa fa-redo"></i> New Bill</button>
</div>

<datalist id="bloodTests">
    <option value="Complete Blood Picture (CBP/CBC)">
    <option value="Lipid Profile (Cholesterol, Triglycerides)">
    <option value="Liver Function Test (LFT)">
    <option value="Kidney Function Test (KFT/RFT)">
    <option value="Thyroid Profile (T3, T4, TSH)">
    <option value="Diabetic Profile (FBS, PLBS, HbA1c)">
    <option value="Blood Grouping & Rh Type">
    <option value="Hemoglobin (Hb)">
    <option value="Blood Sugar Fasting (FBS)">
    <option value="Blood Sugar Post Lunch (PLBS)">
    <option value="HbA1c (Glycosylated Hemoglobin)">
    <option value="Serum Creatinine">
    <option value="Blood Urea">
    <option value="Uric Acid">
    <option value="Serum Calcium">
    <option value="Vitamin B12">
    <option value="Vitamin D3">
    <option value="Dengue NS1 Antigen">
    <option value="Malaria Parasite (MP)">
    <option value="Typhoid (Widal Test)">
    <option value="HIV I & II">
    <option value="HBsAg (Hepatitis B)">
    <option value="Urine Routine Examination">
    <option value="Stool Routine Examination">
    <option value="CRP (C-Reactive Protein)">
</datalist>

<div class="invoice-sheet">
    
    <div class="header">
        <div class="hospital-info">
            <input type="text" class="hospital-input" value="CARE N CURE" placeholder="Hospital Name">
            <textarea class="sub-input" rows="2" style="resize:none;">Bada Mahalla, Lunani Nagar, Tangellamudi, Eluru-534005, Andhra Pradesh</textarea>
            <input type="text" class="sub-input" value="Ph: 093933 23233 | Email: carencure@email.com" placeholder="Contact Info">
        </div>
        <div class="invoice-meta">
            <div class="meta-group">
                <span class="meta-label">Bill No:</span>
                <input type="text" value="CNC-2024-001" style="width: 100px; text-align: right;">
            </div>
            <div class="meta-group">
                <span class="meta-label">Date:</span>
                <input type="date" id="billDate" style="width: 130px; text-align: right;">
            </div>
            <div class="meta-group">
                <span class="meta-label">Time:</span>
                <input type="time" id="billTime" style="width: 100px; text-align: right;">
            </div>
        </div>
    </div>

    <div class="patient-section">
        <div class="row">
            <div class="col">
                <label class="label">Patient Name</label>
                <input type="text" placeholder="Enter Patient Name" style="font-weight: bold;">
            </div>
            <div class="col">
                <label class="label">Age / Gender</label>
                <div style="display:flex; gap:10px;">
                    <input type="number" placeholder="Age" style="width:60px;">
                    <select style="width:100px;"><option>Male</option><option>Female</option><option>Other</option></select>
                </div>
            </div>
            <div class="col">
                <label class="label">Ref. Doctor</label>
                <input type="text" placeholder="Dr. Name">
            </div>
        </div>
        <div class="row" style="margin-bottom:0;">
            <div class="col">
                <label class="label">Address / Mobile</label>
                <input type="text" placeholder="Patient Address / Phone">
            </div>
            <div class="col">
                <label class="label">UHID / Lab ID</label>
                <input type="text" placeholder="LAB-9988">
            </div>
        </div>
    </div>

    <table id="billTable">
        <thead>
            <tr>
                <th>Test Description / Service</th>
                <th class="qty-col">Qty</th>
                <th class="price-col">Rate (₹)</th>
                <th class="total-col">Amount (₹)</th>
                <th class="action-col"></th>
            </tr>
        </thead>
        <tbody>
            </tbody>
    </table>

    <button class="btn-add" onclick="addRow()">+ Add Test / Service</button>

    <div class="totals-section">
        <div class="totals-box">
            <div class="total-row">
                <span>Subtotal</span>
                <span id="subTotal">₹0.00</span>
            </div>
            <div class="total-row">
                <span>Tax / GST (%) <input type="number" id="taxRate" value="0" oninput="calcTotal()" style="width:40px; text-align:center; border:1px solid #ddd;"></span>
                <span id="taxAmount">₹0.00</span>
            </div>
            <div class="total-row">
                <span>Discount (₹)</span>
                <input type="number" id="discount" value="0" oninput="calcTotal()" style="width:80px; text-align:right;">
            </div>
            <div class="total-row grand-total">
                <span>Total Due</span>
                <span id="grandTotal">₹0.00</span>
            </div>
        </div>
    </div>

    <div style="margin-top: 60px; display: flex; justify-content: space-between; align-items: flex-end;">
        <div style="text-align: center;">
            <div style="border-bottom: 1px solid #333; width: 150px; margin-bottom: 5px;"></div>
            <small style="font-weight:600;">Patient Signature</small>
        </div>
        <div style="text-align: center;">
            <div style="border-bottom: 1px solid #333; width: 150px; margin-bottom: 5px;"></div>
            <small style="font-weight:600;">Authorized Signatory<br>For Care n Cure</small>
        </div>
    </div>

    <div class="footer-note">
        <input type="text" value="Thank you. Report will be available within 24 hours." style="text-align: center; width: 100%;">
    </div>

</div>

<script>
    // Set Default Date/Time
    document.getElementById('billDate').valueAsDate = new Date();
    document.getElementById('billTime').value = new Date().toTimeString().slice(0,5);

    const tbody = document.querySelector('#billTable tbody');

    // Add Row Function with INR and Datalist
    function addRow(desc = '', qty = 1, price = 0) {
        const tr = document.createElement('tr');
        tr.innerHTML = `
            <td><input type="text" class="desc" list="bloodTests" value="${desc}" placeholder="Type test name (e.g. CBC, Lipid...)"></td>
            <td><input type="number" class="qty" value="${qty}" min="1" oninput="calcRow(this)"></td>
            <td><input type="number" class="price" value="${price}" min="0" step="0.01" oninput="calcRow(this)"></td>
            <td class="amount">₹0.00</td>
            <td class="action-col"><button class="btn-remove" onclick="removeRow(this)">×</button></td>
        `;
        tbody.appendChild(tr);
        calcRow(tr.querySelector('.qty')); // Initial Calc
    }

    function removeRow(btn) {
        btn.closest('tr').remove();
        calcTotal();
    }

    function calcRow(input) {
        const tr = input.closest('tr');
        const qty = parseFloat(tr.querySelector('.qty').value) || 0;
        const price = parseFloat(tr.querySelector('.price').value) || 0;
        const total = qty * price;
        tr.querySelector('.amount').innerText = '₹' + total.toFixed(2);
        tr.dataset.total = total;
        calcTotal();
    }

    function calcTotal() {
        let sub = 0;
        document.querySelectorAll('tr').forEach(tr => {
            if(tr.dataset.total) sub += parseFloat(tr.dataset.total);
        });

        const taxRate = parseFloat(document.getElementById('taxRate').value) || 0;
        const discount = parseFloat(document.getElementById('discount').value) || 0;

        const tax = sub * (taxRate / 100);
        const grand = (sub + tax) - discount;

        document.getElementById('subTotal').innerText = '₹' + sub.toFixed(2);
        document.getElementById('taxAmount').innerText = '₹' + tax.toFixed(2);
        document.getElementById('grandTotal').innerText = '₹' + grand.toFixed(2);
    }

    function resetBill() {
        if(confirm("Start a new bill? Current data will be lost.")) {
            location.reload();
        }
    }

    // Initialize with common blood tests for Care n Cure
    addRow('Complete Blood Picture (CBP/CBC)', 1, 350);
    addRow('Blood Sugar Fasting (FBS)', 1, 100);
    addRow('Thyroid Profile (T3, T4, TSH)', 1, 600);
    addRow('', 1, 0); // Empty row for user input

</script>

</body>
</html>
