<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hospital Bill Generator</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #2563eb;
            --text: #1f2937;
            --border: #e5e7eb;
            --bg: #f3f4f6;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
        }

        /* --- THE INVOICE SHEET (A4 Size) --- */
        .invoice-sheet {
            background: white;
            width: 210mm; /* A4 Width */
            min-height: 297mm; /* A4 Height */
            padding: 20mm;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            position: relative;
            box-sizing: border-box;
        }

        /* --- EDITABLE FIELDS STYLING --- */
        input, textarea, select {
            border: 1px dashed #ccc;
            padding: 5px;
            font-family: inherit;
            color: inherit;
            background: transparent;
            width: 100%;
            box-sizing: border-box;
            border-radius: 4px;
        }
        input:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            background: rgba(37, 99, 235, 0.05);
        }
        
        /* HEADER */
        .header { display: flex; justify-content: space-between; align-items: flex-start; border-bottom: 2px solid var(--primary); padding-bottom: 20px; margin-bottom: 20px; }
        .hospital-info { width: 60%; }
        .hospital-input { font-size: 1.8rem; font-weight: bold; color: var(--primary); margin-bottom: 5px; border: none; }
        .sub-input { font-size: 0.9rem; color: #666; margin-bottom: 2px; }
        
        .invoice-meta { text-align: right; width: 35%; }
        .meta-group { display: flex; gap: 10px; margin-bottom: 5px; align-items: center; justify-content: flex-end; }
        .meta-label { font-weight: bold; font-size: 0.9rem; }

        /* PATIENT INFO */
        .patient-section { background: #f8fafc; padding: 15px; border-radius: 8px; margin-bottom: 25px; border: 1px solid var(--border); }
        .row { display: flex; gap: 20px; margin-bottom: 10px; }
        .col { flex: 1; }
        .label { font-size: 0.8rem; color: #666; display: block; margin-bottom: 3px; }

        /* BILLING TABLE */
        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        th { text-align: left; background: var(--primary); color: white; padding: 10px; font-size: 0.9rem; }
        td { border-bottom: 1px solid var(--border); padding: 10px; vertical-align: top; }
        
        .qty-col { width: 60px; }
        .price-col { width: 100px; text-align: right; }
        .total-col { width: 100px; text-align: right; font-weight: bold; background: #f9fafb; }
        .action-col { width: 40px; text-align: center; }

        .btn-remove { color: red; cursor: pointer; border: none; background: none; font-size: 1.2rem; }
        .btn-add {
            display: block; width: 100%; padding: 10px; background: #ecfdf5; 
            color: #059669; border: 1px dashed #059669; text-align: center; 
            cursor: pointer; margin-top: 10px; border-radius: 5px; font-weight: bold;
        }
        .btn-add:hover { background: #d1fae5; }

        /* TOTALS SECTION */
        .totals-section { display: flex; justify-content: flex-end; margin-top: 20px; }
        .totals-box { width: 300px; }
        .total-row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #eee; }
        .grand-total { font-size: 1.3rem; font-weight: bold; color: var(--primary); border-top: 2px solid var(--primary); border-bottom: none; }

        /* FOOTER / CONTROLS */
        .controls {
            position: fixed; top: 20px; right: 20px; display: flex; flex-direction: column; gap: 10px;
        }
        .float-btn {
            background: var(--primary); color: white; border: none; padding: 15px 20px;
            border-radius: 50px; cursor: pointer; box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            font-weight: bold; display: flex; align-items: center; gap: 10px; transition: transform 0.2s;
        }
        .float-btn:hover { transform: translateY(-2px); background: #1d4ed8; }
        .float-btn.secondary { background: white; color: var(--text); }

        .footer-note { margin-top: 40px; text-align: center; font-size: 0.8rem; color: #999; border-top: 1px solid #eee; padding-top: 10px; }

        /* --- PRINT MODE (THE MAGIC) --- */
        @media print {
            body { background: white; padding: 0; }
            .invoice-sheet { box-shadow: none; width: 100%; padding: 0; margin: 0; }
            .controls, .btn-add, .action-col, .btn-remove { display: none !important; }
            input, textarea, select { border: none !important; resize: none; padding: 0; }
            /* Hide placeholders on print */
            input::placeholder { color: transparent; }
            /* Expand sheet to full paper */
            @page { margin: 15mm; }
        }
    </style>
</head>
<body>

<div class="controls">
    <button class="float-btn" onclick="window.print()"><i class="fa fa-print"></i> Print / PDF</button>
    <button class="float-btn secondary" onclick="resetBill()"><i class="fa fa-redo"></i> New Bill</button>
</div>

<div class="invoice-sheet">
    
    <div class="header">
        <div class="hospital-info">
            <input type="text" class="hospital-input" value="CITY GENERAL HOSPITAL" placeholder="Hospital Name">
            <input type="text" class="sub-input" value="123 Medical Center Dr, New York, NY" placeholder="Address Line 1">
            <input type="text" class="sub-input" value="Ph: (555) 019-2834 | Email: billing@hospital.com" placeholder="Contact Info">
        </div>
        <div class="invoice-meta">
            <div class="meta-group">
                <span class="meta-label">Bill No:</span>
                <input type="text" value="#INV-2024-001" style="width: 100px; text-align: right;">
            </div>
            <div class="meta-group">
                <span class="meta-label">Date:</span>
                <input type="date" id="billDate" style="width: 130px; text-align: right;">
            </div>
            <div class="meta-group">
                <span class="meta-label">Time:</span>
                <input type="time" id="billTime" style="width: 100px; text-align: right;">
            </div>
        </div>
    </div>

    <div class="patient-section">
        <div class="row">
            <div class="col">
                <label class="label">Patient Name</label>
                <input type="text" placeholder="John Doe" style="font-weight: bold;">
            </div>
            <div class="col">
                <label class="label">Age / Gender</label>
                <div style="display:flex; gap:10px;">
                    <input type="number" placeholder="45" style="width:60px;">
                    <select style="width:100px;"><option>Male</option><option>Female</option><option>Other</option></select>
                </div>
            </div>
            <div class="col">
                <label class="label">Doctor In-Charge</label>
                <input type="text" placeholder="Dr. Smith">
            </div>
        </div>
        <div class="row" style="margin-bottom:0;">
            <div class="col">
                <label class="label">Address</label>
                <input type="text" placeholder="123 Patient St, City">
            </div>
            <div class="col">
                <label class="label">UHID / Reg No.</label>
                <input type="text" placeholder="REG-998877">
            </div>
        </div>
    </div>

    <table id="billTable">
        <thead>
            <tr>
                <th>Description / Service</th>
                <th class="qty-col">Qty</th>
                <th class="price-col">Rate</th>
                <th class="total-col">Amount</th>
                <th class="action-col"></th>
            </tr>
        </thead>
        <tbody>
            </tbody>
    </table>

    <button class="btn-add" onclick="addRow()">+ Add Item</button>

    <div class="totals-section">
        <div class="totals-box">
            <div class="total-row">
                <span>Subtotal</span>
                <span id="subTotal">$0.00</span>
            </div>
            <div class="total-row">
                <span>Tax (%) <input type="number" id="taxRate" value="0" oninput="calcTotal()" style="width:40px; text-align:center; border:1px solid #ddd;"></span>
                <span id="taxAmount">$0.00</span>
            </div>
            <div class="total-row">
                <span>Discount</span>
                <input type="number" id="discount" value="0" oninput="calcTotal()" style="width:80px; text-align:right;">
            </div>
            <div class="total-row grand-total">
                <span>Total Due</span>
                <span id="grandTotal">$0.00</span>
            </div>
        </div>
    </div>

    <div style="margin-top: 50px; display: flex; justify-content: space-between;">
        <div style="text-align: center;">
            <div style="border-bottom: 1px solid black; width: 150px; margin-bottom: 5px;"></div>
            <small>Patient Signature</small>
        </div>
        <div style="text-align: center;">
            <div style="border-bottom: 1px solid black; width: 150px; margin-bottom: 5px;"></div>
            <small>Authorized Signatory</small>
        </div>
    </div>

    <div class="footer-note">
        <input type="text" value="Get well soon! This is a computer generated invoice." style="text-align: center; width: 100%;">
    </div>

</div>

<script>
    // Set Default Date/Time
    document.getElementById('billDate').valueAsDate = new Date();
    document.getElementById('billTime').value = new Date().toTimeString().slice(0,5);

    const tbody = document.querySelector('#billTable tbody');

    // Default Row
    function addRow(desc = '', qty = 1, price = 0) {
        const tr = document.createElement('tr');
        tr.innerHTML = `
            <td><input type="text" class="desc" value="${desc}" placeholder="Service Name (e.g. Consultation)"></td>
            <td><input type="number" class="qty" value="${qty}" min="1" oninput="calcRow(this)"></td>
            <td><input type="number" class="price" value="${price}" min="0" step="0.01" oninput="calcRow(this)"></td>
            <td class="amount">$0.00</td>
            <td class="action-col"><button class="btn-remove" onclick="removeRow(this)">Ã—</button></td>
        `;
        tbody.appendChild(tr);
        calcRow(tr.querySelector('.qty')); // Initial Calc
    }

    function removeRow(btn) {
        btn.closest('tr').remove();
        calcTotal();
    }

    function calcRow(input) {
        const tr = input.closest('tr');
        const qty = parseFloat(tr.querySelector('.qty').value) || 0;
        const price = parseFloat(tr.querySelector('.price').value) || 0;
        const total = qty * price;
        tr.querySelector('.amount').innerText = '$' + total.toFixed(2);
        tr.dataset.total = total;
        calcTotal();
    }

    function calcTotal() {
        let sub = 0;
        document.querySelectorAll('tr').forEach(tr => {
            if(tr.dataset.total) sub += parseFloat(tr.dataset.total);
        });

        const taxRate = parseFloat(document.getElementById('taxRate').value) || 0;
        const discount = parseFloat(document.getElementById('discount').value) || 0;

        const tax = sub * (taxRate / 100);
        const grand = (sub + tax) - discount;

        document.getElementById('subTotal').innerText = '$' + sub.toFixed(2);
        document.getElementById('taxAmount').innerText = '$' + tax.toFixed(2);
        document.getElementById('grandTotal').innerText = '$' + grand.toFixed(2);
    }

    function resetBill() {
        if(confirm("Start a new bill? Current data will be lost.")) {
            location.reload();
        }
    }

    // Add 3 starter rows
    addRow('General Consultation', 1, 50);
    addRow('Blood Test (CBC)', 1, 30);
    addRow('', 1, 0);

</script>

</body>
</html>
